 <!DOCTYPE html>  <html> <head>   <title>ChainedHashTable.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="../docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="../hashtables/OrderedList.html">                 <span class="base_path">hashtables/</span><span class="file_name">OrderedList.coffee</span>               </a>                                           <a class="source" href="../hashtables/OrderedUniqueList.html">                 <span class="base_path">hashtables/</span><span class="file_name">OrderedUniqueList.coffee</span>               </a>                                           <a class="source" href="../hashtables/ChainedHashTable.html">                 <span class="base_path">hashtables/</span><span class="file_name">ChainedHashTable.coffee</span>               </a>                                           <a class="source" href="../hashtables/UnorderedList.html">                 <span class="base_path">hashtables/</span><span class="file_name">UnorderedList.coffee</span>               </a>                                           <a class="source" href="../hashtables/Element.html">                 <span class="base_path">hashtables/</span><span class="file_name">Element.coffee</span>               </a>                                           <a class="source" href="../loadcss.html">                 <span class="base_path"></span><span class="file_name">loadcss.coffee</span>               </a>                                           <a class="source" href="../EventLogger.html">                 <span class="base_path"></span><span class="file_name">EventLogger.coffee</span>               </a>                                           <a class="source" href="../widgets/ChainedHashTable.html">                 <span class="base_path">widgets/</span><span class="file_name">ChainedHashTable.coffee</span>               </a>                                           <a class="source" href="../widgets/raphael.setfixes.html">                 <span class="base_path">widgets/</span><span class="file_name">raphael.setfixes.coffee</span>               </a>                                           <a class="source" href="../widgets/RecText.html">                 <span class="base_path">widgets/</span><span class="file_name">RecText.coffee</span>               </a>                                           <a class="source" href="../widgets/raphael.class.html">                 <span class="base_path">widgets/</span><span class="file_name">raphael.class.coffee</span>               </a>                                           <a class="source" href="../widgets/LinkedList.html">                 <span class="base_path">widgets/</span><span class="file_name">LinkedList.coffee</span>               </a>                                           <a class="source" href="../widgets/raphael.line.html">                 <span class="base_path">widgets/</span><span class="file_name">raphael.line.coffee</span>               </a>                                           <a class="source" href="../StateMachine.html">                 <span class="base_path"></span><span class="file_name">StateMachine.coffee</span>               </a>                                           <a class="source" href="../HashTables.html">                 <span class="base_path"></span><span class="file_name">HashTables.coffee</span>               </a>                                           <a class="source" href="../modules/ChainedHashTable.html">                 <span class="base_path">modules/</span><span class="file_name">ChainedHashTable.coffee</span>               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               ChainedHashTable.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="nx">define</span> <span class="p">[</span><span class="s1">&#39;./LinkedList&#39;</span><span class="p">,</span> <span class="s1">&#39;vendor/jquery&#39;</span><span class="p">,</span> <span class="s1">&#39;./raphael.class&#39;</span><span class="p">],</span> <span class="nf">(List, $, RC) -&gt;</span>
  <span class="nv">defaults =</span>
    <span class="nv">x: </span><span class="mi">0</span>
    <span class="nv">y: </span><span class="mi">0</span>
    <span class="nv">hashContainerPadding: </span><span class="mi">15</span>  <span class="c1"># Between containing rectangle and list heads</span>
    <span class="nv">verticalInnerPadding: </span><span class="mi">15</span>  <span class="c1"># Between lists</span>
    <span class="nv">linkedListOptions: </span><span class="p">{}</span>     <span class="c1"># Passed on to linked lists</span>

  <span class="nx">RC</span> <span class="k">class</span> <span class="nx">ChainedHashTable</span>
    <span class="nv">init: </span><span class="nf">() -&gt;</span>
      <span class="p">{</span><span class="nv">x: </span><span class="nx">@_x</span><span class="p">,</span> <span class="nv">y: </span><span class="nx">@_y</span><span class="p">}</span> <span class="o">=</span> <span class="nx">@_options</span>
      <span class="nx">@_y</span> <span class="o">+=</span> <span class="nx">@_options</span><span class="p">.</span><span class="nx">hashContainerPadding</span>
      <span class="vi">@_lists = </span><span class="p">{}</span>    <span class="c1"># Lists of values, one per hash</span>
      <span class="vi">@_headWidth = </span><span class="mi">0</span> <span class="c1"># Maximal hash box width</span>
  
    <span class="nv">constructor: </span><span class="nf">(@_paper, @model, opts) -&gt;</span>
      <span class="vi">@_options = </span><span class="nx">$</span><span class="p">.</span><span class="nx">extend</span> <span class="p">{},</span> <span class="nx">defaults</span><span class="p">,</span> <span class="nx">opts</span>
      <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span> <span class="nx">@_options</span><span class="p">.</span><span class="nx">linkedListOptions</span><span class="p">,</span> <span class="nx">List</span><span class="p">.</span><span class="nx">defaults</span>
      <span class="nx">@init</span><span class="p">()</span>
      
      <span class="nx">@model</span><span class="p">.</span><span class="nx">bind</span> <span class="s1">&#39;newHash&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">d</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">@_newHash</span> <span class="nx">d</span><span class="p">.</span><span class="nx">hash</span>
      <span class="nx">@model</span><span class="p">.</span><span class="nx">bind</span> <span class="s1">&#39;insertItem&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">d</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">@_insertItem</span> <span class="nx">d</span><span class="p">.</span><span class="nx">hash</span><span class="p">,</span> <span class="nx">d</span><span class="p">.</span><span class="nx">result</span><span class="p">,</span> <span class="nx">d</span><span class="p">.</span><span class="nx">element</span>
      <span class="nx">@model</span><span class="p">.</span><span class="nx">bind</span> <span class="s1">&#39;clear&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">d</span><span class="p">)</span> <span class="o">=&gt;</span>
        <span class="k">for</span> <span class="nx">hash</span><span class="p">,</span> <span class="nx">list</span> <span class="k">of</span> <span class="nx">@_lists</span>
          <span class="nx">list</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
        <span class="nx">@init</span><span class="p">()</span>
        </pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>eof constructor</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nv">_newHash: </span><span class="nf">(hash) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Create the list of items for this hash</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nv">list = </span><span class="nx">@_paper</span><span class="p">.</span><span class="nx">LinkedList</span> <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="nx">@_options</span><span class="p">.</span><span class="nx">linkedListOptions</span><span class="p">,</span>
        <span class="nv">x: </span><span class="nx">@_x</span> <span class="o">+</span> <span class="nx">@_options</span><span class="p">.</span><span class="nx">hashContainerPadding</span><span class="p">,</span>
        <span class="nv">y: </span><span class="nx">@_y</span> <span class="o">+</span> <span class="nx">@_options</span><span class="p">.</span><span class="nx">hashContainerPadding</span>
      <span class="p">)</span>
      <span class="nx">list</span><span class="p">.</span><span class="nx">push</span> <span class="nx">hash</span>
      <span class="nx">@_lists</span><span class="p">[</span><span class="nx">hash</span><span class="p">]</span> <span class="o">=</span> <span class="nx">list</span>
      <span class="nv">b = </span><span class="nx">@_lists</span><span class="p">[</span><span class="nx">hash</span><span class="p">].</span><span class="nx">getBBox</span><span class="p">()</span>
      <span class="vi">@_y = </span><span class="nx">b</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">b</span><span class="p">.</span><span class="nx">height</span> <span class="o">*</span> <span class="mf">1.5</span>

      <span class="nv">newHead = </span><span class="nx">list</span><span class="p">.</span><span class="nx">getBox</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
      <span class="nx">newHead</span><span class="p">.</span><span class="nx">_set</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;rect&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">)</span>
      <span class="nv">newHeadBox = </span><span class="nx">newHead</span><span class="p">.</span><span class="nx">getBBox</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>If this is the new widest box, then resize the others</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="nx">@_headWidth</span> <span class="o">&lt;</span> <span class="nx">newHeadBox</span><span class="p">.</span><span class="nx">width</span>
        <span class="k">for</span> <span class="nx">chash</span><span class="p">,</span> <span class="nx">clist</span> <span class="k">of</span> <span class="nx">@_lists</span>
          <span class="nx">clist</span><span class="p">.</span><span class="nx">resizeBox</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">newHeadBox</span><span class="p">.</span><span class="nx">width</span>
        <span class="vi">@_headWidth = </span><span class="nx">newHeadBox</span><span class="p">.</span><span class="nx">width</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Otherwise give the new box the current greatest width</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">else</span>
        <span class="nx">list</span><span class="p">.</span><span class="nx">resizeBox</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">@_headWidth</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>eof _newHash</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nv">_insertItem: </span><span class="nf">(hash, index, element) -&gt;</span>
      <span class="nx">@_lists</span><span class="p">[</span><span class="nx">hash</span><span class="p">].</span><span class="nx">insertBefore</span> <span class="nx">index</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nx">element</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span> <span class="nx">element</span><span class="p">.</span><span class="nx">value</span> <span class="k">if</span> <span class="nx">index</span> <span class="o">isnt</span> <span class="kc">null</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html>  